// Code generated by goa v3.24.1, DO NOT EDIT.
//
// auth HTTP server types
//
// Command:
// $ goa gen orbo/design

package server

import (
	auth "orbo/gen/auth"

	goa "goa.design/goa/v3/pkg"
)

// LoginRequestBody is the type of the "auth" service "login" endpoint HTTP
// request body.
type LoginRequestBody struct {
	// Username
	Username *string `form:"username,omitempty" json:"username,omitempty" xml:"username,omitempty"`
	// Password
	Password *string `form:"password,omitempty" json:"password,omitempty" xml:"password,omitempty"`
}

// LoginResponseBody is the type of the "auth" service "login" endpoint HTTP
// response body.
type LoginResponseBody struct {
	// JWT access token
	Token string `form:"token" json:"token" xml:"token"`
	// Token expiration timestamp (Unix)
	ExpiresAt int64 `form:"expires_at" json:"expires_at" xml:"expires_at"`
}

// StatusResponseBody is the type of the "auth" service "status" endpoint HTTP
// response body.
type StatusResponseBody struct {
	// Whether authentication is enabled
	Enabled bool `form:"enabled" json:"enabled" xml:"enabled"`
	// Whether current request is authenticated
	Authenticated bool `form:"authenticated" json:"authenticated" xml:"authenticated"`
	// Current username if authenticated
	Username *string `form:"username,omitempty" json:"username,omitempty" xml:"username,omitempty"`
}

// LoginUnauthorizedResponseBody is the type of the "auth" service "login"
// endpoint HTTP response body for the "unauthorized" error.
type LoginUnauthorizedResponseBody struct {
	// Error message
	Message string `form:"message" json:"message" xml:"message"`
}

// NewLoginResponseBody builds the HTTP response body from the result of the
// "login" endpoint of the "auth" service.
func NewLoginResponseBody(res *auth.LoginResult) *LoginResponseBody {
	body := &LoginResponseBody{
		Token:     res.Token,
		ExpiresAt: res.ExpiresAt,
	}
	return body
}

// NewStatusResponseBody builds the HTTP response body from the result of the
// "status" endpoint of the "auth" service.
func NewStatusResponseBody(res *auth.StatusResult) *StatusResponseBody {
	body := &StatusResponseBody{
		Enabled:       res.Enabled,
		Authenticated: res.Authenticated,
		Username:      res.Username,
	}
	return body
}

// NewLoginUnauthorizedResponseBody builds the HTTP response body from the
// result of the "login" endpoint of the "auth" service.
func NewLoginUnauthorizedResponseBody(res *auth.UnauthorizedError) *LoginUnauthorizedResponseBody {
	body := &LoginUnauthorizedResponseBody{
		Message: res.Message,
	}
	return body
}

// NewLoginPayload builds a auth service login endpoint payload.
func NewLoginPayload(body *LoginRequestBody) *auth.LoginPayload {
	v := &auth.LoginPayload{
		Username: *body.Username,
		Password: *body.Password,
	}

	return v
}

// ValidateLoginRequestBody runs the validations defined on LoginRequestBody
func ValidateLoginRequestBody(body *LoginRequestBody) (err error) {
	if body.Username == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("username", "body"))
	}
	if body.Password == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("password", "body"))
	}
	return
}
