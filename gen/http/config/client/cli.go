// Code generated by goa v3.24.1, DO NOT EDIT.
//
// config HTTP client CLI support package
//
// Command:
// $ goa gen orbo/design

package client

import (
	"encoding/json"
	"fmt"
	config "orbo/gen/config"

	goa "goa.design/goa/v3/pkg"
)

// BuildUpdatePayload builds the payload for the config update endpoint from
// CLI flags.
func BuildUpdatePayload(configUpdateBody string) (*config.NotificationConfig, error) {
	var err error
	var body UpdateRequestBody
	{
		err = json.Unmarshal([]byte(configUpdateBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"cooldown_seconds\": 5667207024610732359,\n      \"min_confidence\": 0.13495211,\n      \"telegram_bot_token\": \"Distinctio architecto odio.\",\n      \"telegram_chat_id\": \"Dolore itaque est.\",\n      \"telegram_enabled\": true\n   }'")
		}
	}
	v := &config.NotificationConfig{
		TelegramEnabled:  body.TelegramEnabled,
		TelegramBotToken: body.TelegramBotToken,
		TelegramChatID:   body.TelegramChatID,
		MinConfidence:    body.MinConfidence,
		CooldownSeconds:  body.CooldownSeconds,
	}

	return v, nil
}

// BuildUpdateDinov3Payload builds the payload for the config update_dinov3
// endpoint from CLI flags.
func BuildUpdateDinov3Payload(configUpdateDinov3Body string) (*config.DINOv3Config, error) {
	var err error
	var body UpdateDinov3RequestBody
	{
		err = json.Unmarshal([]byte(configUpdateDinov3Body), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"confidence_threshold\": 0.016302783,\n      \"enable_scene_analysis\": true,\n      \"enabled\": false,\n      \"fallback_to_basic\": true,\n      \"motion_threshold\": 0.69391114,\n      \"service_endpoint\": \"Debitis animi ipsam non.\"\n   }'")
		}
	}
	v := &config.DINOv3Config{
		Enabled:             body.Enabled,
		ServiceEndpoint:     body.ServiceEndpoint,
		MotionThreshold:     body.MotionThreshold,
		ConfidenceThreshold: body.ConfidenceThreshold,
		FallbackToBasic:     body.FallbackToBasic,
		EnableSceneAnalysis: body.EnableSceneAnalysis,
	}
	{
		var zero float32
		if v.MotionThreshold == zero {
			v.MotionThreshold = 0.85
		}
	}
	{
		var zero float32
		if v.ConfidenceThreshold == zero {
			v.ConfidenceThreshold = 0.6
		}
	}
	{
		var zero bool
		if v.FallbackToBasic == zero {
			v.FallbackToBasic = true
		}
	}
	{
		var zero bool
		if v.EnableSceneAnalysis == zero {
			v.EnableSceneAnalysis = true
		}
	}

	return v, nil
}

// BuildUpdateYoloPayload builds the payload for the config update_yolo
// endpoint from CLI flags.
func BuildUpdateYoloPayload(configUpdateYoloBody string) (*config.YOLOConfig, error) {
	var err error
	var body UpdateYoloRequestBody
	{
		err = json.Unmarshal([]byte(configUpdateYoloBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"box_color\": \"Ut omnis error rerum est et magni.\",\n      \"box_thickness\": 3083532263034087331,\n      \"classes_filter\": \"Autem eaque dignissimos rerum.\",\n      \"confidence_threshold\": 0.45829856,\n      \"draw_boxes\": false,\n      \"enabled\": false,\n      \"security_mode\": true,\n      \"service_endpoint\": \"Dolorum deserunt ipsum corporis dolores ullam.\",\n      \"tasks\": [\n         \"detect\",\n         \"pose\"\n      ]\n   }'")
		}
	}
	v := &config.YOLOConfig{
		Enabled:             body.Enabled,
		ServiceEndpoint:     body.ServiceEndpoint,
		ConfidenceThreshold: body.ConfidenceThreshold,
		SecurityMode:        body.SecurityMode,
		ClassesFilter:       body.ClassesFilter,
		DrawBoxes:           body.DrawBoxes,
		BoxColor:            body.BoxColor,
		BoxThickness:        body.BoxThickness,
	}
	{
		var zero float32
		if v.ConfidenceThreshold == zero {
			v.ConfidenceThreshold = 0.5
		}
	}
	{
		var zero bool
		if v.SecurityMode == zero {
			v.SecurityMode = true
		}
	}
	{
		var zero bool
		if v.DrawBoxes == zero {
			v.DrawBoxes = false
		}
	}
	{
		var zero int
		if v.BoxThickness == zero {
			v.BoxThickness = 2
		}
	}
	if body.Tasks != nil {
		v.Tasks = make([]string, len(body.Tasks))
		for i, val := range body.Tasks {
			v.Tasks[i] = val
		}
	}

	return v, nil
}

// BuildUpdateDetectionPayload builds the payload for the config
// update_detection endpoint from CLI flags.
func BuildUpdateDetectionPayload(configUpdateDetectionBody string) (*config.DetectionConfig, error) {
	var err error
	var body UpdateDetectionRequestBody
	{
		err = json.Unmarshal([]byte(configUpdateDetectionBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"dinov3\": {\n         \"confidence_threshold\": 0.8039321,\n         \"enable_scene_analysis\": true,\n         \"enabled\": true,\n         \"fallback_to_basic\": true,\n         \"motion_threshold\": 0.017921131,\n         \"service_endpoint\": \"Impedit dolore.\"\n      },\n      \"fallback_enabled\": true,\n      \"primary_detector\": \"dinov3\",\n      \"yolo\": {\n         \"box_color\": \"Fugit saepe voluptatem.\",\n         \"box_thickness\": 297499421035054028,\n         \"classes_filter\": \"Nesciunt ab corrupti nulla minus.\",\n         \"confidence_threshold\": 0.63516176,\n         \"draw_boxes\": true,\n         \"enabled\": true,\n         \"security_mode\": true,\n         \"service_endpoint\": \"Autem accusantium vel.\",\n         \"tasks\": [\n            \"detect\",\n            \"pose\"\n         ]\n      }\n   }'")
		}
		if !(body.PrimaryDetector == "basic" || body.PrimaryDetector == "yolo" || body.PrimaryDetector == "dinov3") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.primary_detector", body.PrimaryDetector, []any{"basic", "yolo", "dinov3"}))
		}
		if err != nil {
			return nil, err
		}
	}
	v := &config.DetectionConfig{
		PrimaryDetector: body.PrimaryDetector,
		FallbackEnabled: body.FallbackEnabled,
	}
	if body.Yolo != nil {
		v.Yolo = marshalYOLOConfigRequestBodyToConfigYOLOConfig(body.Yolo)
	}
	if body.Dinov3 != nil {
		v.Dinov3 = marshalDINOv3ConfigRequestBodyToConfigDINOv3Config(body.Dinov3)
	}
	{
		var zero bool
		if v.FallbackEnabled == zero {
			v.FallbackEnabled = true
		}
	}

	return v, nil
}

// BuildUpdatePipelinePayload builds the payload for the config update_pipeline
// endpoint from CLI flags.
func BuildUpdatePipelinePayload(configUpdatePipelineBody string) (*config.PipelineConfig, error) {
	var err error
	var body UpdatePipelineRequestBody
	{
		err = json.Unmarshal([]byte(configUpdatePipelineBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"detectors\": [\n         \"yolo\",\n         \"face\"\n      ],\n      \"execution_mode\": \"sequential\",\n      \"mode\": \"visual_only\",\n      \"motion_cooldown_seconds\": 8450747842556392749,\n      \"motion_sensitivity\": 0.29052767,\n      \"schedule_interval\": \"Quae nostrum velit.\"\n   }'")
		}
		if !(body.Mode == "disabled" || body.Mode == "visual_only" || body.Mode == "continuous" || body.Mode == "motion_triggered" || body.Mode == "scheduled" || body.Mode == "hybrid") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.mode", body.Mode, []any{"disabled", "visual_only", "continuous", "motion_triggered", "scheduled", "hybrid"}))
		}
		if !(body.ExecutionMode == "sequential") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.execution_mode", body.ExecutionMode, []any{"sequential"}))
		}
		if body.MotionSensitivity < 0 {
			err = goa.MergeErrors(err, goa.InvalidRangeError("body.motion_sensitivity", body.MotionSensitivity, 0, true))
		}
		if body.MotionSensitivity > 1 {
			err = goa.MergeErrors(err, goa.InvalidRangeError("body.motion_sensitivity", body.MotionSensitivity, 1, false))
		}
		if body.MotionCooldownSeconds < 0 {
			err = goa.MergeErrors(err, goa.InvalidRangeError("body.motion_cooldown_seconds", body.MotionCooldownSeconds, 0, true))
		}
		if err != nil {
			return nil, err
		}
	}
	v := &config.PipelineConfig{
		Mode:                  body.Mode,
		ExecutionMode:         body.ExecutionMode,
		ScheduleInterval:      body.ScheduleInterval,
		MotionSensitivity:     body.MotionSensitivity,
		MotionCooldownSeconds: body.MotionCooldownSeconds,
	}
	if body.Detectors != nil {
		v.Detectors = make([]string, len(body.Detectors))
		for i, val := range body.Detectors {
			v.Detectors[i] = val
		}
	}
	{
		var zero string
		if v.ScheduleInterval == zero {
			v.ScheduleInterval = "5s"
		}
	}
	{
		var zero float32
		if v.MotionSensitivity == zero {
			v.MotionSensitivity = 0.1
		}
	}
	{
		var zero int
		if v.MotionCooldownSeconds == zero {
			v.MotionCooldownSeconds = 2
		}
	}

	return v, nil
}

// BuildUpdateRecognitionPayload builds the payload for the config
// update_recognition endpoint from CLI flags.
func BuildUpdateRecognitionPayload(configUpdateRecognitionBody string) (*config.RecognitionConfig, error) {
	var err error
	var body UpdateRecognitionRequestBody
	{
		err = json.Unmarshal([]byte(configUpdateRecognitionBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"box_thickness\": 4809409892930057921,\n      \"enabled\": false,\n      \"known_face_color\": \"Reprehenderit facilis atque consectetur quibusdam iste est.\",\n      \"service_endpoint\": \"Quia quas.\",\n      \"similarity_threshold\": 0.20452018,\n      \"unknown_face_color\": \"Aut voluptatum error doloribus et eos.\"\n   }'")
		}
	}
	v := &config.RecognitionConfig{
		Enabled:             body.Enabled,
		ServiceEndpoint:     body.ServiceEndpoint,
		SimilarityThreshold: body.SimilarityThreshold,
		KnownFaceColor:      body.KnownFaceColor,
		UnknownFaceColor:    body.UnknownFaceColor,
		BoxThickness:        body.BoxThickness,
	}
	{
		var zero float32
		if v.SimilarityThreshold == zero {
			v.SimilarityThreshold = 0.5
		}
	}
	{
		var zero int
		if v.BoxThickness == zero {
			v.BoxThickness = 2
		}
	}

	return v, nil
}
