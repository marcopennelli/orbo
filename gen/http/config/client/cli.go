// Code generated by goa v3.14.1, DO NOT EDIT.
//
// config HTTP client CLI support package
//
// Command:
// $ goa gen orbo/design

package client

import (
	"encoding/json"
	"fmt"
	config "orbo/gen/config"

	goa "goa.design/goa/v3/pkg"
)

// BuildUpdatePayload builds the payload for the config update endpoint from
// CLI flags.
func BuildUpdatePayload(configUpdateBody string) (*config.NotificationConfig, error) {
	var err error
	var body UpdateRequestBody
	{
		err = json.Unmarshal([]byte(configUpdateBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"cooldown_seconds\": 2217979236458041470,\n      \"min_confidence\": 0.32006893,\n      \"telegram_bot_token\": \"Possimus dolorem officia nulla necessitatibus.\",\n      \"telegram_chat_id\": \"Sed maiores quia delectus.\",\n      \"telegram_enabled\": true\n   }'")
		}
	}
	v := &config.NotificationConfig{
		TelegramEnabled:  body.TelegramEnabled,
		TelegramBotToken: body.TelegramBotToken,
		TelegramChatID:   body.TelegramChatID,
		MinConfidence:    body.MinConfidence,
		CooldownSeconds:  body.CooldownSeconds,
	}

	return v, nil
}

// BuildUpdateDinov3Payload builds the payload for the config update_dinov3
// endpoint from CLI flags.
func BuildUpdateDinov3Payload(configUpdateDinov3Body string) (*config.DINOv3Config, error) {
	var err error
	var body UpdateDinov3RequestBody
	{
		err = json.Unmarshal([]byte(configUpdateDinov3Body), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"confidence_threshold\": 0.76601183,\n      \"enable_scene_analysis\": true,\n      \"enabled\": true,\n      \"fallback_to_basic\": false,\n      \"motion_threshold\": 0.5300217,\n      \"service_endpoint\": \"Commodi commodi ipsa non dolore officiis.\"\n   }'")
		}
	}
	v := &config.DINOv3Config{
		Enabled:             body.Enabled,
		ServiceEndpoint:     body.ServiceEndpoint,
		MotionThreshold:     body.MotionThreshold,
		ConfidenceThreshold: body.ConfidenceThreshold,
		FallbackToBasic:     body.FallbackToBasic,
		EnableSceneAnalysis: body.EnableSceneAnalysis,
	}
	{
		var zero float32
		if v.MotionThreshold == zero {
			v.MotionThreshold = 0.85
		}
	}
	{
		var zero float32
		if v.ConfidenceThreshold == zero {
			v.ConfidenceThreshold = 0.6
		}
	}
	{
		var zero bool
		if v.FallbackToBasic == zero {
			v.FallbackToBasic = true
		}
	}
	{
		var zero bool
		if v.EnableSceneAnalysis == zero {
			v.EnableSceneAnalysis = true
		}
	}

	return v, nil
}

// BuildUpdateYoloPayload builds the payload for the config update_yolo
// endpoint from CLI flags.
func BuildUpdateYoloPayload(configUpdateYoloBody string) (*config.YOLOConfig, error) {
	var err error
	var body UpdateYoloRequestBody
	{
		err = json.Unmarshal([]byte(configUpdateYoloBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"classes_filter\": \"Beatae et doloremque distinctio autem ipsam.\",\n      \"confidence_threshold\": 0.7212448,\n      \"draw_boxes\": true,\n      \"enabled\": false,\n      \"security_mode\": true,\n      \"service_endpoint\": \"Occaecati et omnis.\"\n   }'")
		}
	}
	v := &config.YOLOConfig{
		Enabled:             body.Enabled,
		ServiceEndpoint:     body.ServiceEndpoint,
		ConfidenceThreshold: body.ConfidenceThreshold,
		SecurityMode:        body.SecurityMode,
		ClassesFilter:       body.ClassesFilter,
		DrawBoxes:           body.DrawBoxes,
	}
	{
		var zero float32
		if v.ConfidenceThreshold == zero {
			v.ConfidenceThreshold = 0.5
		}
	}
	{
		var zero bool
		if v.SecurityMode == zero {
			v.SecurityMode = true
		}
	}
	{
		var zero bool
		if v.DrawBoxes == zero {
			v.DrawBoxes = false
		}
	}

	return v, nil
}

// BuildUpdateDetectionPayload builds the payload for the config
// update_detection endpoint from CLI flags.
func BuildUpdateDetectionPayload(configUpdateDetectionBody string) (*config.DetectionConfig, error) {
	var err error
	var body UpdateDetectionRequestBody
	{
		err = json.Unmarshal([]byte(configUpdateDetectionBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"dinov3\": {\n         \"confidence_threshold\": 0.14756961,\n         \"enable_scene_analysis\": false,\n         \"enabled\": true,\n         \"fallback_to_basic\": true,\n         \"motion_threshold\": 0.31562462,\n         \"service_endpoint\": \"Quis et aliquid.\"\n      },\n      \"fallback_enabled\": false,\n      \"primary_detector\": \"basic\",\n      \"yolo\": {\n         \"classes_filter\": \"Porro ullam ipsa nesciunt porro atque ut.\",\n         \"confidence_threshold\": 0.94479585,\n         \"draw_boxes\": true,\n         \"enabled\": true,\n         \"security_mode\": false,\n         \"service_endpoint\": \"Ad necessitatibus quo deleniti.\"\n      }\n   }'")
		}
		if !(body.PrimaryDetector == "basic" || body.PrimaryDetector == "yolo" || body.PrimaryDetector == "dinov3") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.primary_detector", body.PrimaryDetector, []any{"basic", "yolo", "dinov3"}))
		}
		if err != nil {
			return nil, err
		}
	}
	v := &config.DetectionConfig{
		PrimaryDetector: body.PrimaryDetector,
		FallbackEnabled: body.FallbackEnabled,
	}
	if body.Yolo != nil {
		v.Yolo = marshalYOLOConfigRequestBodyToConfigYOLOConfig(body.Yolo)
	}
	if body.Dinov3 != nil {
		v.Dinov3 = marshalDINOv3ConfigRequestBodyToConfigDINOv3Config(body.Dinov3)
	}
	{
		var zero bool
		if v.FallbackEnabled == zero {
			v.FallbackEnabled = true
		}
	}

	return v, nil
}
